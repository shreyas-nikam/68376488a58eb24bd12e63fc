id: 68376488a58eb24bd12e63fc_documentation
summary: Yield-Based Bond Duration Measures and Properties Documentation
feedback link: https://docs.google.com/forms/d/e/1FAIpQLSfWkOK-in_bMMoHSZfcIvAeO58PAH9wrDqcxnJABHaxiDqhSA/viewform?usp=sf_link
environments: Web
status: Published
# FRN Duration Visualizer Codelab\\n\\nThis codelab provides a comprehensive guide to understanding and utilizing the FRN (Floating Rate Note) Duration Visualizer application built using Streamlit. This application is designed to help developers and finance professionals understand the concept of Macaulay Duration and how it is affected by various FRN parameters.\\n\\n## Importance of the Application\\n\\nUnderstanding the duration of financial instruments is crucial for risk management and investment strategies. This application provides an interactive way to visualize the impact of different FRN parameters on its Macaulay Duration, offering insights into its price sensitivity to interest rate changes.\\n\\n## Concepts Explained\\n\\nThis codelab and the associated application will help you grasp the following key concepts:\\n\\n*   **Floating Rate Notes (FRNs):** Understand what FRNs are and how their coupon rates are tied to reference rates.\\n*   **Macaulay Duration:** Learn about the definition, calculation, and importance of Macaulay Duration as a measure of a bond's price sensitivity to interest rate changes.\\n*   **Impact of FRN Parameters:** Explore how changes in notional amount, coupon rate, reference rate spread, reset period, maturity date, and start date affect the Macaulay Duration of an FRN.\\n\\n## Application Architecture\\n\\nThe application follows a simple two-file structure:\\n\\n1.  `app.py`: This is the main Streamlit application file. It handles the overall layout, title, introduction, and navigation. It also imports and runs the FRN duration calculation page.\\n\\n2.  `application_pages/frn_duration.py`: This file contains the core logic for the FRN duration calculator, including the `calculate_macaulay_duration` function and the Streamlit components for user interaction.\\n\\n## Setting up the Environment\\n\\nDuration: 00:05\\n\\nTo run this application, you'll need Python 3.6 or later and the following libraries:\\n\\n*   Streamlit\\n*   Pandas\\n*   Numpy\\n*   Plotly\\n\\nYou can install them using pip:\\n\\n```bash\\npip install streamlit pandas numpy plotly\\n```\\n\\n## Running the Application\\n\\nDuration: 00:02\\n\\nNavigate to the directory containing `app.py` and run the following command:\\n\\n```bash\\nstreamlit run app.py\\n```\\n\\nThis will open the application in your web browser.\\n\\n## Exploring `app.py`\\n\\nDuration: 00:10\\n\\nLet's examine the code in `app.py`:\\n\\n```python\\nimport streamlit as st\\n\\nst.set_page_config(page_title=\\\"FRN Duration Visualizer\\\", layout=\\\"wide\\\")\\nst.sidebar.image(\\\"https://www.quantuniversity.com/assets/img/logo5.jpg\\\")\\nst.sidebar.divider()\\nst.title(\\\"FRN Duration Visualizer\\\")\\nst.divider()\\n\\nst.markdown(\\\"\\\"\\\"\\nIn this lab, we will explore the concept of Macaulay Duration for Floating Rate Notes (FRNs).\\nThis application allows you to interactively change FRN parameters such as notional amount, coupon rate, reference rate spread, reset period, maturity date, and start date, and observe the impact on Macaulay Duration.\\n\\n**Macaulay Duration** is a measure of the weighted-average time until an investor receives the bond's cash flows. It's expressed in years and is a crucial indicator of a bond's price sensitivity to changes in interest rates.\\n\\n**Formula:**\\n\\nWhere:\\n\\n*   `t` = Time until cash flow\\n*   `PV(CFt)` = Present value of the cash flow at time `t`\\n*   `Σ` = Summation\\n\\\"\\\"\\\")\\n\\npage = st.sidebar.selectbox(label=\\\"Navigation\\\", options=[\\\"FRN Duration Calculator\\\"])\\n\\nif page == \\\"FRN Duration Calculator\\\":\\n    from application_pages.frn_duration import run_frn_duration\\n    run_frn_duration()\\n\\nst.divider()\\nst.write(\\\"© 2025 QuantUniversity. All Rights Reserved.\\\")\\nst.caption(\\\"The purpose of this demonstration is solely for educational use and illustration. \\\"\\n           \\\"Any reproduction of this demonstration \\\"\\n           \\\"requires prior written consent from QuantUniversity.\\\")\\n```\\n\\nThis code performs the following actions:\\n\\n*   **Imports Streamlit:**  `import streamlit as st` imports the Streamlit library, aliased as `st`.\\n*   **Sets Page Configuration:** `st.set_page_config` sets the title and layout of the Streamlit application. The `layout=\\\"wide\\\"` argument makes the app use the full width of the browser.\\n*   **Adds Sidebar Content:** `st.sidebar.image`, `st.sidebar.divider` add an image and a divider to the sidebar.\\n*   **Sets Title and Introduction:** `st.title` sets the main title of the application, and `st.markdown` displays an introductory text explaining the purpose of the application and the concept of Macaulay Duration.\\n*   **Creates Navigation:** `st.sidebar.selectbox` creates a dropdown menu in the sidebar, allowing users to select different pages. In this case, there's only one page: \\\"FRN Duration Calculator\\\".\\n*   **Conditional Page Loading:** The `if page == \\\"FRN Duration Calculator\\\":` block checks which page is selected and then imports and runs the corresponding code. In this case, it imports the `run_frn_duration` function from `application_pages/frn_duration.py` and executes it.\\n*   **Adds Footer:** `st.divider`, `st.write`, and `st.caption` add a divider and copyright information to the bottom of the page.\\n\\n## Exploring `application_pages/frn_duration.py`\\n\\nDuration: 00:20\\n\\nNow let's dive into `application_pages/frn_duration.py`:\\n\\n```python\\nimport streamlit as st\\nimport pandas as pd\\nimport numpy as np\\nimport datetime\\nimport plotly.express as px\\nfrom typing import Callable, Optional\\n\\n\\ndef calculate_macaulay_duration(notional: float, coupon_rate: float, reference_rate_spread: float, reset_period: str, maturity_date: datetime.date, start_date: datetime.date) -> float:\\n    \\\"\\\"\\\"\\n    Calculates the Macaulay Duration of a Floating Rate Note (FRN).\\n\\n    Args:\\n        notional (float): The notional amount of the FRN.\\n        coupon_rate (float): The base coupon rate of the FRN (e.g., tied to a reference rate).\\n        reference_rate_spread (float): The spread added to the coupon rate.\\n        reset_period (str): The reset period of the FRN (\\\"Monthly\\\", \\\"Quarterly\\\", \\\"Semi-Annually\\\", \\\"Annually\\\").\\n        maturity_date (datetime.date): The maturity date of the FRN.\\n        start_date (datetime.date): The start date of the FRN.\\n\\n    Returns:\\n        float: The Macaulay Duration of the FRN in years. Returns 0 if there is an error.\\n    \\\"\\\"\\\"\\n    try:\\n        # Determine the number of payments per year based on the reset period\\n        if reset_period == \\\"Monthly\\\":\\n            payments_per_year = 12\\n        elif reset_period == \\\"Quarterly\\\":\\n            payments_per_year = 4\\n        elif reset_period == \\\"Semi-Annually\\\":\\n            payments_per_year = 2\\n        else:  # Annually\\n            payments_per_year = 1\\n\\n        # Calculate the time to maturity in years\\n        time_to_maturity = (maturity_date - start_date).days / 365.25\\n\\n        # Calculate the periodic coupon rate\\n        periodic_coupon_rate = (coupon_rate + reference_rate_spread) / payments_per_year\\n\\n        # Calculate the number of periods\\n        number_of_periods = int(time_to_maturity * payments_per_year)\\n\\n        # Discount rate -  using coupon rate as the discount rate for simplicity\\n        discount_rate = coupon_rate\\n\\n        # Generate cash flows\\n        cash_flows = [notional * periodic_coupon_rate] * number_of_periods\\n        cash_flows[-1] += notional  # Add notional to the last cash flow\\n\\n        # Calculate present values and weighted times\\n        present_values = []\\n        weighted_times = []\\n        for i, cf in enumerate(cash_flows):\\n            t = (i + 1) / payments_per_year  # Time of cash flow\\n            pv = cf / (1 + discount_rate/payments_per_year)**(i + 1)\\n            present_values.append(pv)\\n            weighted_times.append(t * pv)\\n\\n        # Calculate Macaulay Duration\\n        macaulay_duration = sum(weighted_times) / sum(present_values)\\n\\n        return macaulay_duration\\n\\n    except Exception as e:\\n        print(f\\\"Error calculating Macaulay Duration: {e}\\\")\\n        return 0.0\\n\\n\\ndef run_frn_duration():\\n    st.header(\\\"FRN Duration Calculator\\\")\\n\\n    notional = st.number_input(\\\"Notional Amount\\\", value=1000.0)\\n    coupon_rate = st.slider(\\\"Coupon Rate (%)\\\", min_value=0.0, max_value=10.0, value=5.0) / 100  # Divide by 100 to represent as decimal\\n    reference_rate_spread = st.slider(\\\"Reference Rate Spread (%)\\\", min_value=0.0, max_value=2.0, value=1.0) / 100 # Divide by 100 to represent as decimal\\n    reset_period = st.selectbox(\\\"Reset Period\\\", options=[\\\"Monthly\\\", \\\"Quarterly\\\", \\\"Semi-Annually\\\", \\\"Annually\\\"], index=1)\\n    maturity_date = st.date_input(\\\"Maturity Date\\\", value=datetime.date(2030, 12, 31))\\n    start_date = st.date_input(\\\"Start Date\\\", value=datetime.date(2024,1,1))\\n\\n    macaulay_duration = calculate_macaulay_duration(notional, coupon_rate, reference_rate_spread, reset_period, maturity_date, start_date)\\n\\n    st.metric(\\\"Macaulay Duration (Years)\\\", value=round(macaulay_duration, 3))\\n\\n    # Create a DataFrame for visualization\\n    reset_periods = [\\\"Monthly\\\", \\\"Quarterly\\\", \\\"Semi-Annually\\\", \\\"Annually\\\"]\\n    durations = []\\n    for period in reset_periods:\\n        duration = calculate_macaulay_duration(notional, coupon_rate, reference_rate_spread, period, maturity_date, start_date)\\n        durations.append(duration)\\n\\n    df = pd.DataFrame({\\\"Reset Period\\\": reset_periods, \\\"Macaulay Duration\\\": durations})\\n\\n    # Create a bar chart using Plotly\\n    fig = px.bar(df, x=\\\"Reset Period\\\", y=\\\"Macaulay Duration\\\", title=\\\"Macaulay Duration vs. Reset Period\\\")\\n    st.plotly_chart(fig, use_container_width=True)\\n```\\n\\nHere's a breakdown of the code:\\n\\n*   **Imports:** It imports necessary libraries like `streamlit`, `pandas`, `numpy`, `datetime`, and `plotly.express`.\\n*   **`calculate_macaulay_duration` function:**\\n    *   This function takes FRN parameters as input and calculates the Macaulay Duration.\\n    *   It determines the number of payments per year based on the `reset_period`.\\n    *   It calculates the time to maturity in years.\\n    *   It calculates the periodic coupon rate.\\n    *   It calculates the number of periods.\\n    *   It generates cash flows for each period, adding the notional amount to the last cash flow.\\n    *   It calculates the present value of each cash flow and multiplies it by the time until the cash flow.\\n    *   Finally, it calculates the Macaulay Duration using the formula: `sum(weighted_times) / sum(present_values)`.\\n    *   Error handling is included to return 0.0 in case of any exception.\\n*   **`run_frn_duration` function:**\\n    *   This function contains the Streamlit code to create the FRN Duration Calculator interface.\\n    *   It uses `st.header` to display the title of the calculator.\\n    *   It uses `st.number_input`, `st.slider`, and `st.selectbox` to create interactive input widgets for the FRN parameters.\\n    *   It calls the `calculate_macaulay_duration` function with the user-provided inputs.\\n    *   It displays the calculated Macaulay Duration using `st.metric`.\\n    *   It creates a Pandas DataFrame to store the Macaulay Duration for different reset periods.\\n    *   It uses `plotly.express` to create a bar chart visualizing the relationship between reset period and Macaulay Duration.\\n    *   It displays the chart using `st.plotly_chart`.\\n\\n## Interacting with the Application\\n\\nDuration: 00:15\\n\\n1.  **Notional Amount:** Change the notional amount using the `st.number_input` widget. Observe how it affects the Macaulay Duration.  Increasing the notional amount does not affect the Macaulay Duration directly because it scales all cash flows proportionally.\\n\\n2.  **Coupon Rate:** Use the `st.slider` to adjust the coupon rate. Notice the inverse relationship between the coupon rate and the Macaulay Duration. Higher coupon rates lead to lower durations because a larger portion of the bond's value is received earlier in the form of coupon payments.\\n\\n3.  **Reference Rate Spread:** Modify the reference rate spread using the `st.slider`. Similar to the coupon rate, a higher spread reduces the Macaulay Duration.\\n\\n4.  **Reset Period:** Select different reset periods from the `st.selectbox`.  The shorter the reset period, the closer the FRN's duration is to its time to the next reset, often close to zero.\\n\\n5.  **Maturity Date:** Experiment with different maturity dates using the `st.date_input`. Longer maturity dates generally increase the Macaulay Duration.\\n\\n6.  **Start Date:** Modify the start date using the `st.date_input`.  Changing the start date, while keeping the maturity date constant, alters the time to maturity, which impacts the duration.\\n\\nObserve how the \\\"Macaulay Duration (Years)\\\" metric and the bar chart change in real-time as you adjust the parameters. The bar chart helps visualize the impact of different reset periods on the Macaulay Duration.\\n\\n## Understanding the Calculation\\n\\nDuration: 00:10\\n\\nThe `calculate_macaulay_duration` function implements the standard formula for calculating Macaulay Duration. It calculates the present value of each cash flow and weights it by the time until the cash flow is received. The sum of these weighted present values, divided by the sum of all present values, gives the Macaulay Duration.\\n\\n<aside class=\\\"positive\\\">\\n  Understanding the formula and its implementation is key to interpreting the results of the application. Consider experimenting with different FRN parameters and observing their impact on the calculated duration.\\n</aside>\\n\\n## Further Exploration\\n\\nDuration: 00:08\\n\\nHere are some suggestions for further exploration:\\n\\n*   **Add More Sophisticated Discounting:**  Incorporate a more complex yield curve for discounting cash flows instead of using just the coupon rate.\\n*   **Implement Modified Duration:**  Extend the application to calculate modified duration, which is another important measure of interest rate risk.\\n*   **Add More Visualizations:**  Create additional charts and graphs to visualize the relationship between FRN parameters and duration. For example, you could create a scatter plot showing the relationship between coupon rate and duration.\\n*   **Sensitivity Analysis:**  Implement a sensitivity analysis feature to show how the duration changes with small changes in each parameter.\\n\\n<aside class=\\\"negative\\\">\\nRemember that this application is for educational purposes. The calculations are simplified and may not be accurate for all real-world scenarios.\\n</aside>\\n\\n## Conclusion\\n\\nThis codelab has provided a comprehensive guide to understanding and using the FRN Duration Visualizer application. By exploring the code and interacting with the application, you should have gained a better understanding of Macaulay Duration and how it is affected by various FRN parameters. This knowledge is essential for anyone working with fixed-income securities and managing interest rate risk.